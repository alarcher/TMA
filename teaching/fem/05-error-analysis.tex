
\chapter{Error analysis}\label{sec:error_analysis}

The goal of this section is to bound the approximation error $e_h = u - u_h$ in a Sobolev or Lebesgue norm.
To this purpose we have already two ingredients:

--- on the one hand, in the analysis of Ritz and Galerkin methods, consistency estimates like Cea's Lemma give a control on the approximation error in the solution space $\xV$ in term of ``distance'' between the solution space and the approximation space:
\begin{equation*}
\norm{u - u_h}_\xV  \leq C \norm{u - v_h}_\xV\quad,\; \forany v_h \in \xVh
\end{equation*}
with $C > 0$ a constant real number,

--- on the other hand, the pointwise interpolation inequality of Theorem \eqref{th:polyinterpol} gives a control on the interpolation error $e_{\pi} = u - \Projh{k} u$, \ie the difference between any function and its interpolate by Lagrange polynomials of order $k$.

\medskip
For consistency with the notation introduced in Chapter \ref{sec:fem} for the Lagrange interpolation operator in the Finite Element setting, $\Iop{h}^k$ will stand for the Lagange $\xP_k$ interpolation operator in this section.

\medskip
\Question Can we control the approximation error by bounding the right-hand side of the consistency inequality using interpolation properties?

%-------------------------------------------------------------------------------
\section{Preliminary discussion on the Poisson problem}

In the previous chapters, to the weak formulation derived for the Poisson problem with homogeneous Dirichlet boundary conditions and $f\in\xLtwo(\dom)$,
\begin{equation*}
\left\lvert
\begin{array}{ll}
\mbox{Find $u\in \xV = \xHonec(\dom)$ such that:}\\[2ex]
\displaystyle\int_\dom \Grad{u}\xDot\Grad{v} \dx = \int_\dom f\;v \dx\;,\quad\forany v \in\xV\\[2ex]
\end{array}
\right.
\end{equation*}
we associated a Galerkin problem,
\begin{equation*}
\left\lvert
\begin{array}{ll}
\mbox{Find $u_h\in\xVh\subset\xHonec(\dom)$ such that:}\\[2ex]
\displaystyle\int_\dom \Grad{u_h}\xDot\Grad{v} \dx = \int_\dom f\;v \dx\;,\quad\forany v \in\xVh\\[2ex]
\end{array}
\right.
\end{equation*}
by simply looking for a finite dimensional solution.

\medskip
In a first stage, we verified that the problem is well-posed for the chosen solution and test spaces, and that the exact solution $u$ and discrete solution $u_h$ satisfy both a relation of the type
\begin{equation*}
\snorm{u}_{\xHone(\dom)} \leq C \norm{f}_{\xLtwo(\dom)}
\end{equation*}
with $C > 0$, which we denoted as \textit{a priori} estimate.

\medskip
In a second stage, without making any further assumption on the approximation space $\xVh$, a general result was introduced showing that the distance between the exact solution and the approximate solution $\norm{u - u_h}_{\xV}$ is bounded by the distance of $u$ to the best approximation of $u$ in $\xVh$; this is Cea's Lemma.
For the sake of completeness, the estimate corresponding to Cea's Lemma is given in the case of the Poisson problem with homogeneous Dirichlet boundary conditions.
\begin{equation*}
E = \snorm{u - u_h}^2_{\xHone(\dom)} = \int_\dom \Abs{\Grad(u - u_h)}^2\md x = \int_\dom \Grad(u - u_h)\xDot\Grad(u - u_h) \md x
\end{equation*}

For any $v_h\in\xVh$
\begin{equation*}
E = \int_\dom \Grad(u - u_h)\xDot\Grad(u - v_h) \md x + \int_\dom \Grad(u - u_h)\xDot\Grad(v_h - u_h) \md x
\end{equation*}
and the second term cancels by virtue of consistency (Galerkin orthogonality), so that Cauchy--Scwarz gives
\begin{equation*}
E = \snorm{u - u_h}^2_{\xHone(\dom)} \leq \Bigl(\int_\dom \Abs{\Grad(u - u_h)}^2 \md x\Bigr)^{1/2} \Bigl(\int_\dom \Abs{\Grad(u - v_h)}^2 \md x\Bigr)^{1/2}
\end{equation*}
thus
\begin{equation*}
\snorm{u - u_h}_{\xHone(\dom)} \leq \snorm{u - v_h}_{\xHone(\dom)}
\end{equation*}


As introduced, the relation
\begin{equation}\label{eq:error_estimate_h1}
\snorm{e_h}_{\xHone(\dom)} \leq \snorm{u - v_h}_{\xHone(\dom)}
\end{equation}
means that the \textit{approximation error} $e_h = u - u_h$ is controlled as soon as we are able to bound the distance between $u$ and its best representant in $\xVh$.

\medskip
In a third stage, we introduced Finite Element approximation spaces based on Lagrange polynomials, Definition \ref{def:lagrange_poly}.
Their local interpolation operator given here in one dimension,
\begin{equation*}
\LgrK{k} v = \sum_{j=0}^k v(x_j) \Lgr{k}{j}
\end{equation*}
satisfies Inequality \eqref{th:polyinterpol} controlling the interpolation error $\Abs{v - \LgrK{k} v}$ pointwise on $K$.

\medskip
The idea is to derive similar inequalities but in Sobolev and Lebesgue norms so that the right-hand side of Equation \eqref{eq:error_estimate_h1} can be bounded by a function $\epsilon$ of the mesh size $\sizeT$, such that $\epsilon(\sizeT) \tendsto 0$ as $\sizeT \tendsto 0$.
Inequalities of the form
\begin{equation*}
\norm{e_h} \leq C \epsilon(\sizeT)
\end{equation*}
for some constant $C$ depending on the domain and the exact solution, are called \textit{a priori error estimates}.
Usually $\epsilon(\sizeT) \sim O(\sizeT^r)$, with $r > 0$ the convergence rate of the method.
In this case sequences of approximate solution $(u_h)_{\sizeT}$ converge to the exact solution $u$, as fast as the function $\epsilon$ allows, when $\sizeT$ tends to zero.

\medskip
The goal of this section is to derive such error estimates after proving required interpolation inequalities.
In particular the space of continuous linear Lagrange elements
\begin{equation}\label{sp:lagrangeP1}
\xVh = \lbrace v \in \xC^0(\bar\dom)\cap\xHonec(\dom) : \forany K \in \meshT, \Restrict{v}{K} \in \xPone(K) \rbrace
\end{equation}
will be considered, then more general results will be stated without proof.

%-------------------------------------------------------------------------------
\section{Stability of the Lagrange interpolation operator}

Before moving to interpolation inequalities, the \textit{stability} of the interpolation operator should be proved: such estimate shows that any interpolate of a function in $\xV$ is also in $\xV$.
Inequality \eqref{eq:stability_lagrange_p1} is also called uniform continuity in zero of the interpolation operator since $C$ does not depend on $\meshT$, but only on the domain $\dom$.

\begin{prpstn}[$\xHone$-stability of the Lagrange $\xPone$ interpolation operator]
There exists a constant $C>0$ such that,
\begin{equation}\label{eq:stability_lagrange_p1}
\norm{\Lgrh{1} v}_{\xHone(\dom)} \leq C\; \norm{v}_{\xHone(\dom)}
\end{equation}
\end{prpstn}
\begin{proof}
Since $\norm{\;\cdot\;}^2_{\xHone} = \norm{\;\cdot\;}^2_{\xLtwo} + \snorm{\;\cdot\;}^2_{\xHone}$ then the $\xLtwo$ norm of the interpolate and its derivative should be controlled. Since controlling the derivative of a function in $\xLtwo$ gives a control on the function in $\xLtwo$ (PoincarÃ© inequality), it is natural to start looking for an estimate of $\snorm{\;\cdot\;}_{\xHone}$, then move to $\norm{\;\cdot\;}_{\xLtwo}$.
\begin{tmaproofitems}
\item Estimate in $\snorm{\;\cdot\;}_{\xHone}$:
\[
\Restrict{\bigl(\Lgrh{1}v\bigr)'}{K} = \bigl(\LgrK{1}v\bigr)' = h_K^{-1}\bigl(v(x_{i+1})- v(x_{i}))
\]



\item Estimate in $\norm{\;\cdot\;}_{\xLtwo}$:
\end{tmaproofitems}
\end{proof}

%-------------------------------------------------------------------------------
\section{\textit{A priori} error estimate with Lagrange $\xPone$}

\begin{thrm}[Interpolation inequality in $\xHonec(\dom)$ and $\xLtwo(\dom)$]
Let $v \in \xHtwo(\dom)$, $\exists C_1 > 0$ such that
\begin{equation}
\snHoneD{v - \Lgrh{1}v}  \leq C_1 \sizeT\;\snHtwoD{v}
\end{equation}
and $\exists C_0 > 0$ such that
\begin{equation}
\nLtwo{v - \Lgrh{1}v}  \leq C_0 \sizeT^2 \snHtwoD{v}
\end{equation}
with $\sizeT = \max_{K\in\meshT}(h_K)$.
\end{thrm}
\begin{proof}
The proof is based on the Mean-Value Theorem and a decomposition of the error per element.
The global interpolation error is then recovered by summing over the cells.
This makes sense since the polynomial estimate is defined pointwise: this is then a local property.
In the same spirit the stability of the interpolation operator is also a local property, defined element-wise.

\medskip
\begin{tmaproofitems}
\item Estimate in $\snorm{\;\cdot\;}_{\xHone}$:
\item Estimate in $\norm{\;\cdot\;}_{\xLtwo}$:
\end{tmaproofitems}

\end{proof}

The approximation error being bounded in $O(\sizeT)$ the method is first order in $\xHonec(\dom)$.

\begin{rmrk}[Convergence order in $\xHone(\dom)$]
On the other hand we know that $\exists C_I > 0 $ such that, $\forany v \in \xHtwo(\dom)$:
\begin{equation*}
\nLtwo{v - \Lgrh{1} v} \leq C_I\; \sizeT^2 \snHtwoD{v}
\end{equation*}
Using the definition of the norm
\begin{equation*}
\nHoneD{v - \Lgrh{1} v}^2 = \nLtwo{v - \Lgrh{1} v}^2 + \snHoneD{v - \Lgrh{1} v}^2
\end{equation*}
we get:
\begin{equation*}
\nHoneD{v - \Lgrh{1} v}^2 \leq C_I^2\; (\sizeT^4 \snHtwoD{v}^2 + \sizeT^2 \snHtwoD{v}^2)
\end{equation*}
\begin{equation*}
\nHoneD{v - \Lgrh{1} v} \leq C_I\; \sizeT\;(1 + \sizeT^2)^{1/2} \snHtwoD{v}
\end{equation*}
Thus, we verify that the approximation is also first order in $\xHone(\dom)$.
\end{rmrk}

%-------------------------------------------------------------------------------
\section{Superconvergence}

The following result shows the the convergence properties of the method is not only limited by the interpolation inequality.
Indeed, using a result by Aubin--Nitsche, we show that even if the approximation is not $\xHtwo$-conformal, we can improve the error estimate by one order: the convergence order in $\xLtwo(\dom)$ becomes then two.

\begin{thrm}[Superconvergence]
Let $\dom$ be a convex polygonal subset of $\xR^d$, $d \geq 1$, $f \in \xLtwo(\dom)$, $u$ solution to the Dirichlet Problem \eqref{pb:poisson} and $u_h$ approximate solution, $\sizeT\;= \max_{K\in\meshT}(h_K)$:
\begin{equation*}
\nHoneD{u - u_h}  \leq C_1\;\sizeT\quad\mbox{and}\quad\nLtwo{u - u_h}  \leq C_0\;\sizeT^2
\end{equation*}
\end{thrm}

\begin{proof}
If $u$ is solution to the Poisson problen then $u \in \xHonec(\dom)$, then by regularity Theorem \eqref{th:poisson_regularity} (by density of $\xHtwo(\dom)$ in $\xHone(\dom)$), $u \in \xHtwo(\dom)$, thus $\exists C_1 > 0$ such that:
\begin{equation*}
\nHtwoD{u}  \leq C_1\;\nLtwo{f}
\end{equation*}
Thus replacing the $\xHtwo$-seminorm in the right-hand side of the error estimate, we have
\begin{equation}\label{eq:h1err_eh}
\nHoneD{u - u_h}  \leq C_1\;\sizeT\;\nLtwo{f}
\end{equation}
Let us introduce the following auxiliary problem:
\begin{subequations}\label{pb:aubin_nitsche}
\begin{equation}\label{pb:aubin_nitsche_eq}
- \Lap \varphi(\x) = e_h(\x)\quad,\;x\in\dom
\end{equation}
\begin{equation}\label{pb:aubin_nitsche_bc}
\varphi(\x) = 0\quad,\;x\in\partial\dom
\end{equation}
\end{subequations}
and its weak formulation:
\begin{equation}\label{pb:weak_aubin_nitsche}
\left\lvert
\begin{array}{ll}
\mbox{Find $\varphi \in \xHonec(\dom)$, given $e_h \in \xLtwo(\dom)$, such that:}\\[2ex]
\displaystyle\int_\dom \Grad \varphi\xDot \Grad \phi\dx = \int_\dom e_h \phi  \dx\quad,\;\forany  \phi\in \xHonec(\dom)
\end{array}
\right .
\end{equation}
Since $e_h$ is bounded in $\xLtwo(\dom)$ then the same regularity result holds for the auxiliary Problem \eqref{pb:aubin_nitsche}, $\exists C_2 > 0$ such that:
\begin{equation*}
\nHtwoD{\varphi}  \leq C_2\;\nLtwo{e_h}
\end{equation*}
and thus:
estimate, we have
\begin{equation}\label{eq:h1err_phih}
\nHoneD{\varphi - \varphi_h}  \leq C_2\;\sizeT\;\nLtwo{e_h}
\end{equation}

\medskip
Let us try to bound the $\xLtwo$-norm of the approximation error by noticing that its amounts to take $\phi = e_h$ in \eqref{pb:weak_aubin_nitsche}:
\begin{equation*}
\nLtwo{e_h} = \int_\dom |e_h|^2 \dx = \int_\dom \Grad \varphi\xDot \Grad e_h\dx
\end{equation*}
If we consider the approximate of Problem \eqref{pb:weak_aubin_nitsche} by Galerkin method, with $\varphi_h \in \xVh$ its solution, then the Galerkin orthogonality reads:
\begin{equation*}
\int_\dom \Grad \varphi_h\xDot \Grad e_h\dx  = 0
\end{equation*}
Thus we can substract and add this latter to the previous expression:
\begin{equation*}
\nLtwo{e_h} = \int_\dom \Grad (\varphi - \varphi_h)\xDot \Grad e_h\dx + \underbrace{\int_\dom \Grad \varphi_h\xDot \Grad e_h\dx}_{0}
\end{equation*}
First we use Cauchy-Schwarz and make the $\xHone$-norm of the approximation errors appear since we control them by Equation \eqref{eq:h1err_eh} and \eqref{eq:h1err_phih}:
\begin{equation*}
\nLtwo{e_h} \leq \nHoneD{\varphi - \varphi_h} \nHoneD{e_h}
\end{equation*}

\medskip
Replacing by the bounds from the interpolation inequalities we get:
\begin{equation*}
\nLtwo{e_h} \leq C_1\;C_2\;\sizeT^2\;\nLtwo{f}
\end{equation*}
which concludes the proof. We have then a second order error estimate in $\xLtwo$.
\end{proof}

\newpage
%-------------------------------------------------------------------------------
\section{Exercises}


