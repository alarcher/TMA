
\chapter{Error analysis}\label{chap:ea}

The goal of this section is to bound the approximation error $e_h = u - u_h$ in a Sobolev or Lebesgue norm.
To this purpose we have already two ingredients:

--- on the one hand, in the analysis of Ritz and Galerkin methods, consistency estimates like Cea's Lemma give a control on the approximation error in the solution space $\xV$ in term of ``distance'' between the solution space and the approximation space:
\begin{equation*}
\norm{u - u_h}_\xV  \leq C \norm{u - v_h}_\xV\quad,\; \forany v_h \in \xVh
\end{equation*}
with $C > 0$ a constant real number,

--- on the other hand, the pointwise interpolation inequality of Theorem \eqref{th:polyinterpol} gives a control on the interpolation error $e_{\pi} = u - \Projh{k} u$, \ie the difference between any function and its interpolate by Lagrange polynomials of order $k$.

\medskip
For consistency with the notation introduced in Chapter \ref{sec:fem} for the Lagrange interpolation operator in the Finite Element setting, $\Iop{h}^k$ will stand for the Lagange $\xP_k$ interpolation operator in this section.

\medskip
\Question Can we control the approximation error by bounding the right-hand side of the consistency inequality using interpolation properties?

%-------------------------------------------------------------------------------
\section{Preliminary discussion on the Poisson problem}

In the previous chapters, the weak problem derived for the Poisson problem with homogeneous Dirichlet boundary conditions and $f\in\xLtwo(\dom)$,
\begin{equation*}
\left\lvert
\begin{array}{ll}
\mbox{Find $u\in \xV = \xHonec(\dom)$ such that:}\\[2ex]
\displaystyle\intD \Grad{u}\xDot\Grad{v} \dxx = \intD f\;v \dxx\;,\quad\forany v \in\xV\\[2ex]
\end{array}
\right.
\end{equation*}
was approximated by a Galerkin problem,
\begin{equation*}
\left\lvert
\begin{array}{ll}
\mbox{Find $u_h\in\xVh\subset\xHonec(\dom)$ such that:}\\[2ex]
\displaystyle\intD \Grad{u_h}\xDot\Grad{v} \dxx = \intD f\;v \dxx\;,\quad\forany v \in\xVh\\[2ex]
\end{array}
\right.
\end{equation*}
by simply looking for a finite dimensional solution.

\medskip
In a first stage, we verified that the weak problem is well-posed for the chosen solution and test spaces, and that the exact solution $u$ and discrete solution $u_h$ satisfy both a relation of the type
\begin{equation*}
\snorm{u}_{\xHone(\dom)} \leq C \norm{f}_{\xLtwo(\dom)}
\end{equation*}
with $C > 0$, which we denoted as \textit{a priori} estimate.

\medskip
In a second stage, without making any further assumption on the approximation space $\xVh$, a general result was introduced showing that the distance between the exact solution and the approximate solution $\norm{u - u_h}_{\xV}$ is bounded by the distance of $u$ to the best approximation of $u$ in $\xVh$; this is Cea's Lemma.
For the sake of completeness, the estimate corresponding to Cea's Lemma is given in the case of the Poisson problem with homogeneous Dirichlet boundary conditions.
\begin{equation*}
E = \snorm{u - u_h}^2_{\xHone(\dom)} = \intD \Abs{\Grad(u - u_h)}^2\dxx = \intD \Grad(u - u_h)\xDot\Grad(u - u_h) \dxx
\end{equation*}

For any $v_h\in\xVh$
\begin{equation*}
E = \intD \Grad(u - u_h)\xDot\Grad(u - v_h) \dxx + \intD \Grad(u - u_h)\xDot\Grad(v_h - u_h) \dxx
\end{equation*}
and the second term cancels by virtue of consistency (Galerkin orthogonality), so that Cauchy--Scwarz gives
\begin{equation*}
E = \snorm{u - u_h}^2_{\xHone(\dom)} \leq \left(\intD \Abs{\Grad(u - u_h)}^2 \dxx\right)^{\sfrac{1}{2}} \left(\intD \Abs{\Grad(u - v_h)}^2 \dxx\right)^{\sfrac{1}{2}}
\end{equation*}
thus
\begin{equation*}
\snorm{u - u_h}_{\xHone(\dom)} \leq \snorm{u - v_h}_{\xHone(\dom)}
\end{equation*}


As introduced, the relation
\begin{equation}\label{eq:error_estimate_h1}
\snorm{e_h}_{\xHone(\dom)} \leq \snorm{u - v_h}_{\xHone(\dom)}
\end{equation}
means that the \textit{approximation error} $e_h = u - u_h$ is controlled as soon as we are able to bound the distance between $u$ and its best representant in $\xVh$.

\medskip
In a third stage, we introduced Finite Element approximation spaces based on Lagrange polynomials, Definition \ref{def:lagrange_poly}.
Their local interpolation operator given here in one dimension,
\begin{equation*}
\LgrK{k} v = \sum_{j=0}^k v(\xi_j) \Lgr{k}{j}
\end{equation*}
with Lagrange nodes $\Fam{\xi_j}$, satisfies Inequality \eqref{th:polyinterpol} controlling the \textit{interpolation error} $e_\imath = v - \LgrK{k} v$ pointwise on $K$.

\medskip
Inequality \eqref{eq:error_estimate_h1} can be written
\begin{equation}\label{eq:error_estimate_h1_2}
\snorm{e_h}_{\xHone(\dom)} \leq \snorm{e_\imath}_{\xHone(\dom)}
\end{equation}
which means that the \textit{approximation error} is bounded by the \textit{interpolation error}.
From pointwise polynomial interpolation estimates we need to derive inequalities in Sobolev and Lebesgue norms, so that the right-hand side of Equation \eqref{eq:error_estimate_h1_2} can be bounded by a function $\epsilon$ of the mesh size $\sizeT$, such that $\epsilon(\sizeT) \tendsto 0$ as $\sizeT \tendsto 0$; convergence of the approximation is then ensured.

\medskip
Inequalities of the form
\begin{equation*}
\norm{e_h} \leq C \epsilon(\sizeT)
\end{equation*}
for some constant $C$ depending on the domain and the exact solution, are called \textit{a priori error estimates}.
Usually $\epsilon(\sizeT) \sim O(\sizeT^r)$, with $r > 0$ the convergence rate of the method, which represents the expected \textit{accuracy}.
In this case sequences of approximate solution $(u_h)_{\sizeT}$ converge to the exact solution $u$, as fast as the function $\epsilon$ allows, when $\sizeT$ tends to zero.

\medskip
The goal of this section is to derive such error estimates after proving required interpolation inequalities.
In particular the space of continuous linear Lagrange elements
\begin{equation}\label{sp:lagrangeP1}
\xVh = \lbrace v \in \xC^0(\bar\dom)\cap\xHonec(\dom) : \forany K \in \meshT, \Restrict{v}{K} \in \xPone(K) \rbrace
\end{equation}
will be considered, then more general results will be stated without proof.

%-------------------------------------------------------------------------------
\section{Stability of the Lagrange interpolation operator}

Before moving to interpolation inequalities, the \textit{stability} of the interpolation operator should be proved: such estimate shows that the interpolate of any function in $\xV$ is also in $\xV$.
The exposé is restricted to the one-dimensional case and detailed so that anybody without prior experience in estimates should be able to follow the procedure.

\medskip
Interpolation properties need to be reformulated in terms of estimates in $\xLtwo$ norms.
First they are expressed elementwise, then on the entire domain by collecting contributions over the mesh.
To give a better idea, let us introduce below an ingredient used for subsequent estimates, considering a function $v\in\xHone(I)$ with $I$ an interval, and two points $\xi, x \in I$.
\begin{equation*}
\begin{array}{lcl}
\Abs{v(x) - v(\xi)} &=&    \displaystyle\Abs{\int_\xi^x v'(s) \md s}\\[2ex]
                    &\leq& \displaystyle\int_\xi^x \Abs{v'(s)} \md s\\[2ex]
                    &\leq& \displaystyle|x - \xi|^{\sfrac{1}{2}}\left(\int_\xi^x \Abs{v'(s)}^{2} \md s\right)^{\sfrac{1}{2}}\\[2ex]
\end{array}
\end{equation*}
using Cauchy--Schwarz with $\Abs{v'(s)}$ and $\indic{[\xi, x]}$, the indicator function on $[\xi, x]$.
Since we assumed that $v\in\xHone(I)$, then the right-hand side of
\begin{equation}\label{eq:interpolation_estimate_1}
\Abs{v(x) - v(\xi)} \leq \displaystyle|x - \xi|^{\sfrac{1}{2}}\snorm{v}_{\xHone([\xi, x])}
\end{equation}
is bounded.

\medskip
Now let us consider that $\xi$ realizes the minimum of $|v|$ on $I$, then
\begin{equation*}
\Abs{v(x)} \leq |x - \xi|^{\sfrac{1}{2}}\snorm{v}_{\xHone([\xi, x])} + \Abs{v(\xi)},\quad \xi = \argmin{s\in I} |v(s)|
\end{equation*}
using the second triangle inequality.

\medskip
Immediately if $|v(\xi)| = 0$ the estimate gives for any $x\in I$
\begin{equation}\label{eq:interpolation_estimate_2}
\Abs{v(x)} \leq |I|^{\sfrac{1}{2}}\snorm{v}_{\xHone(I)}
\end{equation}
but otherwise we can bound $|v(\xi)|$ using
\begin{equation*}
\Abs{v(\xi)} = \Abs{x-\xi}^{-1} \int_\xi^x \Abs{v(s)} \md s \leq |x - \xi|^{-\sfrac{1}{2}}\norm{v}_{\xLtwo([\xi, x])}
\end{equation*}
so that
\begin{equation*}
\Abs{v(x)} \leq |x - \xi|^{\sfrac{1}{2}}\snorm{v}_{\xHone([\xi, x])} + |x - \xi|^{-\sfrac{1}{2}}\norm{v}_{\xLtwo([\xi, x])}
\end{equation*}
thus for any $x\in I$
\begin{equation}\label{eq:interpolation_estimate_2}
\Abs{v(x)} \leq |I|^{\sfrac{1}{2}}\snorm{v}_{\xHone(I)} + |I|^{-\sfrac{1}{2}}\norm{v}_{\xLtwo(I)}
\end{equation}
in other words
\begin{equation}\label{eq:interpolation_estimate_3}
\norm{v}_{\xLinfty(I)} \leq |I|^{\sfrac{1}{2}}\snorm{v}_{\xHone(I)} + |I|^{-\sfrac{1}{2}}\norm{v}_{\xLtwo(I)}
\end{equation}

\begin{prpstn}[$\xHone$-stability of the Lagrange $\xPone$ interpolation operator]
\label{prpstn:stability_lagrange_p1}
There exists a constant $C>0$ such that,
\begin{equation}\label{eq:stability_lagrange_p1}
\norm{\Lgrh{1} v}_{\xHone(\dom)} \leq C\; \norm{v}_{\xHone(\dom)}
\end{equation}
\end{prpstn}
\begin{proof}
Since $\norm{\;\cdot\;}^2_{\xHone} = \norm{\;\cdot\;}^2_{\xLtwo} + \snorm{\;\cdot\;}^2_{\xHone}$ then the $\xLtwo$ norm of the interpolate and its derivative should be controlled. Since controlling the derivative of a function in $\xLtwo$ gives a control on the function in $\xLtwo$ (Poincaré Inequality), it is natural to start looking for an estimate of $\snorm{\;\cdot\;}_{\xHone}$, then move to $\norm{\;\cdot\;}_{\xLtwo}$.
\begin{tmaproofitems}
\item Estimate in $\snorm{\;\cdot\;}_{\xHone}$:\\
Let us consider the restriction of the interpolation operator to any $K = [x_{i}, x_{i+1}] \in \meshT$
\[
\Restrict{\bigl(\Lgrh{1}v\bigr)'}{K} = \bigl(\LgrK{1}v\bigr)' = h_K^{-1}\bigl(v(x_{i+1})- v(x_{i}))
\]
which is constant over $K$.
The elementwise $\xHone$ semi-norm of the interpolate can be bounded using Inequality \eqref{eq:interpolation_estimate_1}
\begin{equation*}
\begin{array}{lcl}
\snorm{\LgrK{1}v}_{\xHone(K)} &=&\displaystyle \left(\int_K h_K^{-2}\Abs{v(x_{i+1})- v(x_{i})}^2 \dxx\right)^{\sfrac{1}{2}}\\[2ex]
                              &\leq& h_K^{-\sfrac{1}{2}}\Abs{v(x_{i+1})- v(x_{i})}\\[2ex]
                              &\leq& h_K^{-\sfrac{1}{2}} h_K^{\sfrac{1}{2}}\snorm{v}_{\xHone(K)}\\[2ex]
                              &\leq& \snorm{v}_{\xHone(K)}\\
\end{array}
\end{equation*}
Summing over $K$ and using the definition of $\sizeT$,
\begin{equation*}
\snorm{\Lgrh{1}v}_{\xHone(\dom)} \leq \snorm{v}_{\xHone(\dom)}
\end{equation*}
\item Estimate in $\norm{\;\cdot\;}_{\xLtwo}$:\\
In this case we do not need to prove an elementwise estimate first as we already introduced a control of pointwise values in terms of the $\xHone$ seminorm and the $\xLtwo$ norm: it boils down to estimate the maximum attained by the linear interpolate.
\begin{equation*}
\begin{array}{lcl}
\norm{\Lgrh{1}v}_{\xLtwo(\dom)} &=&\displaystyle \left(\intD \Abs{\Lgrh{1}v}^2 \dxx\right)^{\sfrac{1}{2}}\\[2ex]
                              &\leq&\displaystyle \left(\intD \norm{\Lgrh{1}v}_{\xLinfty(\dom)}^2 \dxx\right)^{\sfrac{1}{2}}\\[2ex]
                              &\leq& |\dom|^{\sfrac{1}{2}} \norm{\Lgrh{1}v}_{\xLinfty(\dom)}\\[2ex]
                              &\leq& |\dom|^{\sfrac{1}{2}} \norm{v}_{\xLinfty(\dom)}\\
\end{array}
\end{equation*}
the last line is given by the $\xLinfty$ stability of the linear interpolation: the function and its linear interpolate coincide at Lagrange nodes so that $\norm{\Lgrh{1}v}_{\xLinfty(\dom)} \leq \norm{v}_{\xLinfty(\dom)}$.
Therefore, using Inequality \eqref{eq:interpolation_estimate_3}
\begin{equation*}
\norm{\Lgrh{1}v}_{\xLtwo(\dom)}  \leq |\dom|^{\sfrac{1}{2}}\snorm{v}_{\xHone(\dom)} + |\dom|^{-\sfrac{1}{2}}\norm{v}_{\xLtwo(\dom)}
\end{equation*}
we can conclude using the Poincaré Inequality with constant $c_p$,
\begin{equation*}
\norm{\Lgrh{1}v}_{\xLtwo(\dom)}  \leq (|\dom| + c_p^{-1})\snorm{v}_{\xHone(\dom)}
\end{equation*}
\end{tmaproofitems}
\end{proof}

Inequality \eqref{eq:stability_lagrange_p1} is also called \textit{uniform continuity} in zero of the interpolation operator since $C$ should not depend on $\meshT$; but possibly depends on $\dom$.

%-------------------------------------------------------------------------------
\section{\textit{A priori} error estimate with Lagrange $\xPone$}

\begin{prpstn}[Interpolation Inequalities for Lagrange $\xPone$]
\label{prpstn:interpolation_p1}
There exists two positive constants $C_1$ and $C_0$ such that for any $v\in\xHtwo(\dom)$
\begin{equation}
\snHoneD{v - \Lgrh{1}v}  \leq C_1 \sizeT\;\snHtwoD{v}
\end{equation}
\begin{equation}
\nLtwo{v - \Lgrh{1}v}  \leq C_0 \sizeT^2 \snHtwoD{v}
\end{equation}
with $\sizeT = \max_{K\in\meshT}(h_K)$
\end{prpstn}
\begin{proof}
The proof is sketched in one dimension, based on a decomposition of the error per element and on the Mean-Value Theorem (also known as Rolle Theorem).
The global interpolation error is then recovered by summing over the cells, given that
\begin{equation*}
\norm{e_\imath}^2_{\xLtwo(\dom)} = \sum_{K\in\meshT} \int_K\Abs{e_\imath(x)}^2 \dxx = \sum_{K\in\meshT} \norm{e_\imath}^2_{\xLtwo(K)}
\end{equation*}
This makes sense since the polynomial interpolation estimate is defined pointwise, it is then a local property.
In the same spirit as the stability of the interpolation operator of Proposition \ref{prpstn:stability_lagrange_p1} which we proved first elementwise, the estimate is derived in $\xHone$ semi-norm then in $\xLtwo$ norm.

\medskip
The main technical ingredient is given by Inequality \eqref{eq:interpolation_estimate_1} for a given function $w\in\xHone(K)$,
\begin{equation}\label{eq:interpolation_estimate_trick_1}
\Abs{w(x) - w(\xi)} \leq \displaystyle|x - \xi|^{\sfrac{1}{2}}\snorm{w}_{\xHone([\xi, x])}
\end{equation}
with $\xi, x\in K$.
If we choose $\xi$ such that $w(\xi)$ cancels and if we integrate the square of the expression over any $K\in\meshT$, then we get a control of $w$ in $\xLtwo(K)$,
\begin{equation}\label{eq:interpolation_estimate_trick_2}
\norm{w}_{\xLtwo(K)} \leq \displaystyle|x - \xi|^{\sfrac{1}{2}}\left(\int_K \snorm{w}^2_{\xHone([\xi, x])}\dxx\right)^{\sfrac{1}{2}} \leq h_K\snorm{w}_{\xHone(K)}
\end{equation}

\medskip
\begin{tmaproofitems}
\item Estimate in $\snorm{\;\cdot\;}_{\xHone}$:\\
The elementwise estimate on any $K = [x_{i}, x_{i+1}]$ is obtained by taking $w = (v - \Lgrh{1}v)'$ in Inequality \eqref{eq:interpolation_estimate_trick_1}.
Given that $x_i$ and $x_{i+1}$ are Lagrange nodes, $\bigl(v-\Lgrh{1}v\bigr)(x_i) = 0$ and $\bigl(v-\Lgrh{1}v\bigr)(x_{i+1}) = 0$, then by virtue of the Mean-Value Theorem, there exists $\xi\in[x_{i}, x_{i+1}]$ such that the derivative cancels, $(v-\Lgrh{1}v)'(\xi) = 0$.
Moreover $\snorm{(v-\Lgrh{1}v)'}_{\xHone(K)} = \snorm{v'}_{\xHone(K)}$ since $(v-\Lgrh{1}v)'' = v'' - (\Lgrh{1}v)''$ by linearity and $(\Lgrh{1}v)''$ is identically zero, so we get directly
\begin{equation*}
\norm{(v-\Lgrh{1}v)'}_{\xLtwo(K)} \leq h_K\snorm{v'}_{\xHone(K)}
\end{equation*}
in the same fashion as Inequality \eqref{eq:interpolation_estimate_trick_2}, which can be rewritten under the expected form
\begin{equation}\label{eq:interpolation_estimate_h1}
\snorm{v-\Lgrh{1}v}_{\xHone(K)} \leq h_K\snorm{v}_{\xHtwo(K)}
\end{equation}
\item Estimate in $\norm{\;\cdot\;}_{\xLtwo}$:\\
The elementwise estimate on any $K = [x_{i}, x_{i+1}]$ is obtained by taking $w = (v - \Lgrh{1}v)$ in Inequality \eqref{eq:interpolation_estimate_trick_1}.
Given that $\bigl(v-\Lgrh{1}v\bigr)(x_i) = 0$ and $\bigl(v-\Lgrh{1}v\bigr)(x_{i+1}) = 0$, a similar argument as for the $\xHone$ semi-norm can be used with $\xi = x_i$.
Inequality \eqref{eq:interpolation_estimate_trick_2} with $w = (v - \Lgrh{1}v)$ reads
\begin{equation*}
\norm{v-\Lgrh{1}v}_{\xLtwo(K)} \leq h_K\snorm{v-\Lgrh{1}v}_{\xHone(K)}
\end{equation*}
so that using Inequality \eqref{eq:interpolation_estimate_h1}
\begin{equation*}
\norm{v-\Lgrh{1}v}_{\xLtwo(K)} \leq h^2_K\snorm{v}_{\xHtwo(K)}
\end{equation*}
\end{tmaproofitems}
In both cases global estimates are obtained by summing over $K\in\meshT$ and factoring $\sizeT = \max_{K\in\meshT}(h_K)$.
\end{proof}

\begin{rmrk}[Convergence order in $\xHone$ norm]
Using the definition of the norm
\begin{equation*}
\nHoneD{v - \Lgrh{1} v}^2 = \nLtwo{v - \Lgrh{1} v}^2 + \snHoneD{v - \Lgrh{1} v}^2
\end{equation*}
we get
\begin{equation*}
\nHoneD{v - \Lgrh{1} v}^2 \leq C_I^2\; (\sizeT^4 \snHtwoD{v}^2 + \sizeT^2 \snHtwoD{v}^2)
\end{equation*}
\begin{equation*}
\nHoneD{v - \Lgrh{1} v} \leq C_I\; \sizeT\;(1 + \sizeT^2)^{\sfrac{1}{2}} \snHtwoD{v}
\end{equation*}
Thus we verify that the approximation is first order in $\xHone$ norm if $\snHtwoD{v}$ is bounded.
\end{rmrk}

A more general result Proposition \ref{prpstn:interpolation_pk} can be proved for Lagrange $\xP_k$ Finite Elements, which we verify is equivalent to Proposition \ref{prpstn:interpolation_p1} for $s=1$, $k=1$.

\begin{prpstn}[Interpolation Inequality for Lagrange $\xP_k$, \cite{EG}]\label{prpstn:interpolation_pk}
Given $0\leq s \leq k$, there exists a positive constant $C$ such that for any $v\in\xH^{s+1}(\dom)$,
\begin{equation*}
\norm{v-\Lgrh{1}v}_{\xLtwo(\dom)} + \sizeT \snorm{v-\Lgrh{1}v}_{\xHone(\dom)}\leq C \sizeT^{s+1}\snorm{v}_{\xH^{s+1}(\dom)}
\end{equation*}
\end{prpstn}

One important remark is that the convergence order depends on the regularity of the solution since the order is $s + 1$ for a solution in $\xH^{s+1}(\dom)$.
Unfortunately the Lagrange $\xPone$ Finite Element is only $\xHone$--conformal, so \textit{a priori} it cannot represent functions of $\xHtwo$ accurately.
Given that the solution space is $\xHone$ the interpolation inequality of Proposition \ref{prpstn:interpolation_pk} only applies with $s = 0$ so that the convergence order is only one in $\xLtwo$ norm in the general case, and we have only a weak convergence result in $\xHone$.
In the next section we show that the convergence rate for the Poisson problem approximated with Lagrange $\xPone$ is actually second order in $\xLtwo$ norm and first order in $\xHone$ semi-norm: this is one order more than expected from interpolation inequalities.

%-------------------------------------------------------------------------------
\section{Superconvergence}

The following result shows the the convergence properties of the method is not only limited by interpolation inequalities.
Indeed, using a result by Aubin and Nitsche, we show that even if the approximation is not $\xHtwo$-conformal, we can improve the error estimate by one order: the convergence in $\xLtwo$ becomes then second order in $\sizeT$.
The idea behind this result is that if $u$ is the weak solution to the Poisson equation then it is not only in $\xHonec(\dom)$ since the differential operator involves second order derivatives: we say that $u$ is regularized due to the ellipticity of the operator.

\begin{thrm}[Superconvergence]
Let $\dom$ be a convex polygonal subset of $\xR^d$, $d \geq 1$, $f \in \xLtwo(\dom)$, $u$ solution to the Dirichlet Problem \eqref{pb:poisson} and $u_h$ approximate solution, $\sizeT\;= \max_{K\in\meshT}(h_K)$:
\begin{equation*}
\nHoneD{u - u_h}  \leq C_1\;\sizeT\quad\mbox{and}\quad\nLtwo{u - u_h}  \leq C_0\;\sizeT^2
\end{equation*}
\end{thrm}

\begin{proof}
If $u \in \xHonec(\dom)$ is solution to the Poisson problem, then by elliptic regularity and density of $\xHtwo(\dom)$ in $\xHone(\dom)$), $u \in \xHtwo(\dom)$, thus $\exists\; C_u > 0$ such that:
\begin{equation*}
\nHtwoD{u}  \leq C_u\;\nLtwo{f}
\end{equation*}
Thus replacing the $\xHtwo$ semi-norm in the right-hand side of the error estimate, we have
\begin{equation}\label{eq:h1err_eh}
\nHoneD{u - u_h}  \leq C_u\;\sizeT\;\nLtwo{f}
\end{equation}
Let us introduce the following auxiliary problem:
\begin{subequations}\label{pb:aubin_nitsche}
\begin{equation}\label{pb:aubin_nitsche_eq}
- \Lap \varphi(\xx) = e_h(\xx)\quad,\;\xx\in\dom
\end{equation}
\begin{equation}\label{pb:aubin_nitsche_bc}
\varphi(\xx) = 0\quad,\;\xx\in\partial\dom
\end{equation}
\end{subequations}
obtained by a duality argument, formally
\begin{equation*}
-\Inner{\Lap v}{w} = \Inner{\nabla v}{\nabla w} = -\Inner{v}{\Lap w}
\end{equation*}
by integration by parts; since the adjoint operator of the Laplace operator is the Laplace operator itself, it is said \textit{self-adjoint}.
The motivation of introducing this equation is to control the \textit{approximation error} $e_h$ in $\xLtwo$:
\begin{equation*}
\Inner{e_h}{e_h} = \Inner{e_h}{-\Lap \phi} = \Inner{\nabla e_h}{\nabla \phi} = \Inner{-\Lap e_h}{\phi}
\end{equation*}
for $\phi\in\xHonec(\dom)$ called \textit{dual solution} satisfying $-\Lap \phi = e_h$.

Similarly to the Poisson equation, the weak formulation of Problem $\ref{pb:aubin_nitsche}$ reads:
\begin{equation}\label{pb:weak_aubin_nitsche}
\left\lvert
\begin{array}{ll}
\mbox{Find $\varphi \in \xHonec(\dom)$, given $e_h \in \xLtwo(\dom)$, such that:}\\[2ex]
\displaystyle\intD \Grad \varphi\xDot \Grad \phi\dxx = \intD e_h \phi  \dxx\quad,\;\forany  \phi\in \xHonec(\dom)
\end{array}
\right .
\end{equation}
Since $e_h$ is bounded in $\xLtwo(\dom)$ then the same regularity result holds for the auxiliary Problem \eqref{pb:aubin_nitsche}, $\exists C_\varphi > 0$ such that:
\begin{equation*}
\nHtwoD{\varphi}  \leq C_\varphi\;\nLtwo{e_h}
\end{equation*}
so we have from the interpolation inequality for $\varphi$
\begin{equation}\label{eq:h1err_phih}
\nHoneD{\varphi - \varphi_h}  \leq C_\varphi\;\sizeT\;\nLtwo{e_h}
\end{equation}

\medskip
Let us try to bound the $\xLtwo$ norm of the approximation error by noticing that its amounts to take $\phi = e_h$ in \eqref{pb:weak_aubin_nitsche}:
\begin{equation*}
\nLtwo{e_h} = \intD |e_h|^2 \dxx = \intD \Grad \varphi\xDot \Grad e_h\dxx
\end{equation*}
If we consider the approximate of Problem \eqref{pb:weak_aubin_nitsche} by Galerkin method, with $\varphi_h \in \xVh$ its solution, then the Galerkin orthogonality reads:
\begin{equation*}
\intD \Grad \varphi_h\xDot \Grad e_h\dxx  = 0
\end{equation*}
Thus we can subtract and add this latter to the previous expression:
\begin{equation*}
\nLtwo{e_h} = \intD \Grad (\varphi - \varphi_h)\xDot \Grad e_h\dxx + \underbrace{\intD \Grad \varphi_h\xDot \Grad e_h\dxx}_{0}
\end{equation*}
First we use Cauchy-Schwarz and make the $\xHone$ norm of the approximation errors appear since we control them by Equation \eqref{eq:h1err_eh} and \eqref{eq:h1err_phih}:
\begin{equation*}
\nLtwo{e_h} \leq \nHoneD{\varphi - \varphi_h} \nHoneD{e_h}
\end{equation*}

\medskip
Replacing by the bounds from the interpolation inequalities we get:
\begin{equation*}
\nLtwo{e_h} \leq C_u\;C_\varphi\;\sizeT^2\;\nLtwo{f}
\end{equation*}
which concludes the proof. We have then a second order error estimate in $\xLtwo$.
\end{proof}

The conclusion of this result is that the observed convergence order may be different than the order suggested by the interpolation inequality.
As seen in this example it may be improved if the differential operator has a regularizing effect, but can also be influenced by other factors like the regularity of the boundary or the discretization of the computional domain.

\newpage
%-------------------------------------------------------------------------------
\section{Exercises}


